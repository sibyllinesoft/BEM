[mypy]
# Global mypy configuration
# This complements the pyproject.toml configuration with additional settings

# Basic settings
python_version = 3.9
platform = linux

# Import discovery
namespace_packages = True
explicit_package_bases = True
mypy_path = src:tests

# Strict mode settings (also configured in pyproject.toml)
strict = True
warn_return_any = True
warn_unused_configs = True
warn_redundant_casts = True
warn_unused_ignores = True
warn_no_return = True
warn_unreachable = True
strict_equality = True

# Additional strict settings
disallow_any_unimported = True
disallow_any_expr = False  # Too strict for ML code
disallow_any_decorated = False  # Allow for decorators
disallow_any_explicit = False  # Allow explicit Any when needed
disallow_any_generics = True
disallow_subclassing_any = True

# Error reporting
show_error_codes = True
show_column_numbers = True
show_error_context = True
pretty = True
color_output = True
error_summary = True

# Performance
incremental = True
cache_dir = .mypy_cache
sqlite_cache = True

# Miscellaneous strictness flags
no_implicit_reexport = True
strict_optional = True
strict_concatenate = True

# Per-module options for third-party libraries
[mypy-transformers.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-datasets.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-torch.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-torchvision.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-scipy.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-sklearn.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-matplotlib.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-seaborn.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-plotly.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-redis.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-psycopg2.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-sqlalchemy.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-alembic.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-celery.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-prometheus_client.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-wandb.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-mlflow.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-optuna.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-ray.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-tensorboard.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-jupyter.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-IPython.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-notebook.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-fastapi.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-uvicorn.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-starlette.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-httpx.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-aiofiles.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-aioredis.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-asyncpg.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-pydantic.*]
ignore_missing_imports = False  # Pydantic has good type support
follow_imports = normal

[mypy-pytest.*]
ignore_missing_imports = True
follow_imports = skip

[mypy-hypothesis.*]
ignore_missing_imports = True
follow_imports = skip

# Project-specific modules
[mypy-bem_core.*]
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
disallow_untyped_decorators = True
warn_return_any = True

[mypy-bem2.*]
disallow_untyped_defs = True
disallow_incomplete_defs = True
check_untyped_defs = True
disallow_untyped_decorators = True
warn_return_any = True

[mypy-bem_legacy.*]
# Legacy code - more lenient
ignore_errors = False
disallow_untyped_defs = False
disallow_incomplete_defs = False
check_untyped_defs = False
warn_return_any = False

# Test files - slightly more lenient
[mypy-tests.*]
disallow_untyped_defs = False
disallow_incomplete_defs = False
warn_return_any = False
# Allow fixtures and test utilities to be less strict
disallow_any_expr = False
disallow_any_decorated = False

# Scripts - more lenient for utility scripts
[mypy-scripts.*]
ignore_errors = False
disallow_untyped_defs = False
disallow_incomplete_defs = False
check_untyped_defs = False
warn_return_any = False

# Experiment files - very lenient for research code
[mypy-experiments.*]
ignore_errors = True

# Archive - ignore completely
[mypy-archive.*]
ignore_errors = True

# Generated files
[mypy-*_pb2.py]
ignore_errors = True

[mypy-*_pb2_grpc.py]
ignore_errors = True